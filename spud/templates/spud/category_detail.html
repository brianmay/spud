{% extends "base_site.html" %}
{% load i18n %}
{% load photo %}

{% block stylesheet %}{{ MEDIA_URL }}css/photolists.css{% endblock %}

{% block breadcrumbs %}{% show_breadcrumbs breadcrumbs %}{% endblock %}

{% block title %}{{object}}{% endblock %}

{% block extrahead %}{{ block.super }}
{{ media }}
{% endblock %}

{% block content %}
<h1>{{object}} page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</h1>

{% show_view_buttons web user object %}

{% if object.category_description %}<p>{{object.category_description|urlizetrunc:40|linebreaks}}</p>{% endif %}

{%ifequal page_obj.number 1 %}
{% if object.children.all %}
<div class="children">
    <ul class="photo_list">
    {% for category in object.children.all %}
        <li class='photo_list_item' onClick='parent.location="{{ category.get_absolute_url }}"'>
            <a href="{{ category.get_absolute_url }}">
                {% with category.get_cover_photo as photo %}{% if photo %}<img src='{% get_thumb_url photo "thumb" %}' alt=''/><br/>{% endif %}{% endwith %}
                <div class='title'>{{ category }}</div>
            </a>
            {% if category.sortname %}<div class='sort'>({{category.sortname}} {{category.sortorder}})</div>{% endif %}
            {% if category.category_description %}<div class='desc' onClick='parent.location="{{ category.get_absolute_url }}"'>{{category.category_description|urlizetrunc:20}}</div>{% endif %}
        </li>
    {% endfor %}
    <br class="clear"/>
    </ul>
</div>
{% endif %}
{% endifequal %}

{% show_photo_list page_obj web object %}

{% pagination page_obj web %}

<h2>Search</h2>

<form method="post">{% csrf_token %}
<table>{{ form.as_table }}</table>
<input type="submit" />
</form>

{% endblock %}
